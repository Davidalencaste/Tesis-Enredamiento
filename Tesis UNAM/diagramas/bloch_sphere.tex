\documentclass[../Main.tex]{subfiles}

\begin{document}

\begin{figure}
\centering

% Parámetros
\def\r{2.5}
\def\vtheta{45}
\def\vphi{60}
\def\polar{75}
\def\azimuth{130}

% Perspectiva
\tdplotsetmaincoords{\polar}{\azimuth}

\begin{tikzpicture}[scale=1,tdplot_main_coords]

% Origen
\coordinate (O) at (0,0,0);

% Proyección exterior
\draw[tdplot_screen_coords,black!20] (O) circle (\r);

% Paralelos y meridianos
\tdplotsetthetaplanecoords{0}
\foreach \a in {-75,-60,...,75}
  {\tdplotCsDrawLatCircle[thin,black!20]{\r}{\a}}
\foreach \a in {0,30,...,150}
  {\tdplotCsDrawLonCircle[thin,black!20]{\r}{\a}}

% Ecuador
\tdplotCsDrawLatCircle[tdplotCsFill/.style={opacity=0.04}]{\r}{0}

% Ejes
\tdplotsetthetaplanecoords{\vphi}
\draw[thick,->] (O) -- (1.3*\r,0,0) node[anchor=north east] {$x$};
\draw[thick,->] (O) -- (0,1.3*\r,0) node[anchor=north west] {$z$};
\draw[thick,->] (O) -- (0,0,1.3*\r) node[anchor=south] {$y$};

% Estados base
\fill[cyan] (0,0,\r) circle (2pt);
\node[cyan,above right] at (0,0,\r) {$\ket{\downarrow}$};

\fill[orange] (0,0,-\r) circle (2pt);
\node[orange,below] at (0,0,-\r) {$\ket{\uparrow}$};

% Estados en el ecuador
\fill (\r,0,0) circle (1.5pt);
\node[anchor=north east] at (\r,0,0)
{$\tfrac{1}{\sqrt{2}}(\ket{\downarrow}+\ket{\uparrow})$};

\fill (0,\r,0) circle (1.5pt);
\node[anchor=west] at (0,\r,0)
{$\tfrac{1}{\sqrt{2}}(\ket{\downarrow}+i\ket{\uparrow})$};

% Estado completamente mezclado
\fill[black] (O) circle (2pt);
\node[below left] at (O) {$|\bm S|=0$};

% Estado mixto
\tdplotsetcoord{P}{0.75*\r}{\vtheta}{\vphi}
\draw[thick,->,violet] (O) -- (P);
\fill[violet] (P) circle (2pt);
\node[violet,anchor=west] at (P) {$|\bm S|<1$};

% Ángulos
\tdplotdrawarc[->]{(O)}{0.7*\r}{0}{\vphi}
{anchor=north}{$\varphi$}
\tdplotdrawarc[->,tdplot_rotated_coords]{(O)}{0.7*\r}{0}{\vtheta}
{anchor=south east}{$\theta$}

% Texto explicativo
\node[black!60] at (0,-1.6*\r,0)
{Estados puros: $|\bm S|=1$};

\end{tikzpicture}

\caption{Esfera de Bloch para un sistema de espín $1/2$.
Los estados puros corresponden a la superficie ($|\bm S|=1$),
los estados mixtos al interior ($|\bm S|<1$)
y el estado completamente mezclado al origen ($|\bm S|=0$).}
\label{fig:bloch_sphere}

\end{figure}


\end{document}